# Multi-Agent Content Generation System

## Problem Statement

Design and implement a modular agentic automation system using **LangGraph** that takes a product dataset and automatically generates structured, machine-readable content pages including FAQ, Product Description, and Comparison pages.

## Solution Overview

A **LangGraph StateGraph-powered multi-agent system** with **real LLM API calls** for content generation.

### Key Technologies

| Component | Technology |
|-----------|------------|
| Framework | **LangGraph** (StateGraph) |
| LLM Providers | Ollama (local), Gemini, OpenAI |
| Backend | FastAPI |
| Frontend | Vanilla HTML/CSS/JS |
| State Management | TypedDict |
| Output Parsing | Pydantic + JsonOutputParser |

## System Architecture

```mermaid
flowchart TB
    subgraph Input["Input Layer"]
        PD["product_data.json"]
        PDB["product_b_data.json"]
    end

    subgraph LangGraph["LangGraph StateGraph"]
        START((Start)) --> PARSE["parse_products_node"]
        PARSE --> LOGIC["run_logic_blocks_node"]
        LOGIC --> QUESTIONS["generate_questions_node<br/>ðŸ¤– LLM"]
        QUESTIONS --> FAQ["generate_faq_node<br/>ðŸ¤– LLM"]
        FAQ --> PRODUCT["generate_product_node<br/>ðŸ¤– LLM"]
        PRODUCT --> COMPARE["generate_comparison_node<br/>ðŸ¤– LLM"]
        COMPARE --> WRITE["write_outputs_node"]
        WRITE --> END((End))
    end

    subgraph Agents["Independent Agent Classes"]
        QA["QuestionGeneratorAgent"]
        FA["FAQGeneratorAgent"]
        PA["ProductPageAgent"]
        CA["ComparisonAgent"]
    end

    subgraph Output["Output Layer"]
        FJ["faq.json"]
        PPJ["product_page.json"]
        CPJ["comparison_page.json"]
    end

    PD --> START
    PDB --> START
    QUESTIONS -.->|instantiates| QA
    FAQ -.->|instantiates| FA
    PRODUCT -.->|instantiates| PA
    COMPARE -.->|instantiates| CA
    WRITE --> FJ & PPJ & CPJ
```

## Agent Independence

Each agent in `agents/llm_agents.py` is a **self-contained class** that:

1. Has its **own LLM instance** (not shared)
2. Defines its **own system prompt**
3. Can **run independently** without the orchestrator
4. Makes **real LLM API calls**

```python
class QuestionGeneratorAgent(BaseAgent):
    def __init__(self):
        super().__init__("QuestionGeneratorAgent")
        # Gets own LLM via get_llm() factory
    
    def get_system_prompt(self) -> str:
        return """You are a product content expert..."""
    
    def run(self, input_data: Dict) -> Dict:
        chain = prompt | self.llm | JsonOutputParser()
        return chain.invoke(input_data)
```

## LangGraph Execution Flow

```mermaid
sequenceDiagram
    participant G as LangGraph
    participant N as Nodes
    participant A as Independent Agents
    participant L as LLM (Ollama/Gemini)

    G->>N: parse_products_node
    N-->>G: product_a, product_b
    
    G->>N: generate_questions_node
    N->>A: QuestionGeneratorAgent()
    A->>L: Prompt via LangChain
    L-->>A: JSON response
    A-->>N: 21 questions
    N-->>G: questions
    
    Note over G,L: Each agent has own LLM instance
```

## Project Structure

```
kasparro-agentic/
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ llm_agents.py     # Independent agent classes
â”‚   â”œâ”€â”€ nodes.py          # LangGraph node functions
â”‚   â””â”€â”€ graph.py          # LangGraph StateGraph
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ graph_state.py    # TypedDict state
â”‚   â”œâ”€â”€ llm_factory.py    # Multi-provider LLM factory
â”‚   â””â”€â”€ schemas.py        # Pydantic output schemas
â”œâ”€â”€ api/
â”‚   â””â”€â”€ main.py           # FastAPI REST API
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ styles.css
â”‚   â””â”€â”€ app.js            # Dynamic loading (no hardcoded fallbacks)
â”œâ”€â”€ output/               # LLM-generated JSON
â”œâ”€â”€ pyproject.toml        # Proper Python package
â””â”€â”€ requirements.txt
```

## Output Structure

All outputs are **LLM-generated** JSON:

- `faq.json` - 20+ Q&A pairs generated by FAQGeneratorAgent
- `product_page.json` - Product description by ProductPageAgent
- `comparison_page.json` - A vs B comparison by ComparisonAgent
